<!-- dollarId: user.item,v 1.7 2002/08/16 04:29:04 richard Exp dollar-->
<tal:block tal:define="
    editok python:request.user.hasPermission('Edit') or
           user.id == request.user.id;
    viewok python:request.user.hasPermission('View')">

<span tal:condition="python:not (viewok or editok)">
You are not allowed to view this page.
</span>

<tal:block tal:condition="editok">
<form method="POST" onSubmit="return submit_once()" enctype="multipart/form-data">

<input type="hidden" name=":required" value="username,address">

<table class="form">
 <tr>
  <th>Name</th>
  <td tal:content="structure user/realname/field">realname</td>
 </tr>
 <tr>
  <th>Login Name</th>
  <td tal:content="structure user/username/field">username</td>
 </tr>
 <tr>
  <th>Login Password</th>
  <td tal:content="structure user/password/field">password</td>
 </tr>
 <tr tal:condition="python:request.user.hasPermission('Web Roles')">
  <th>Roles</th>
  <td tal:condition="exists:item"
      tal:content="structure user/roles/field">roles</td>
  <td tal:condition="not:exists:item">
   <input name="roles" tal:attributes="value db/config/NEW_WEB_USER_ROLES">
  </td>
 </tr>
 <tr>
  <th>Phone</th>
  <td tal:content="structure user/phone/field">phone</td>
 </tr>
 <tr>
  <th>Organisation</th>
  <td tal:content="structure user/organisation/field">organisation</td>
 </tr>
 <tr>
  <th>E-mail address</th>
  <td tal:content="structure user/address/field">address</td>
 </tr>
 <tr>
  <th>Alternate E-mail addresses<br>One address per line</th>
  <td tal:content="structure user/alternate_addresses/multiline">alternate_addresses</td>
 </tr>

 <tr>
  <td>&nbsp;</td>
  <td tal:content="structure user/submit">submit button here</td>
 </tr>
</table>
</form>

<tal:block tal:condition="exists:item">
 <table class="otherinfo" tal:condition="user/queries">
  <tr><th class="header">Queries</th></tr>
  <tr tal:repeat="query user/queries">
   <td tal:content="query">query</td>
  </tr>
 </table>

 <table class="otherinfo">
  <tr><th class="header">History</th></tr>
  <tr>
   <td tal:content="structure user/history">history</td>
  </tr>
 </table>
</tal:block>

</tal:block>

<table class="form" tal:condition="python:viewok and not editok">
 <tr>
  <th colspan=2 class="header" tal:content="user/realname">realname</th>
 </tr>
 <tr>
  <th>Login Name</th>
  <td tal:content="user/username">username</td>
 </tr>
 <tr>
  <th>Phone</th>
  <td tal:content="user/phone">phone</td>
 </tr>
 <tr>
  <th>Organisation</th>
  <td tal:content="user/organisation">organisation</td>
 </tr>
 <tr>
  <th>E-mail address</th>
  <td tal:content="user/address/email">address</td>
 </tr>
</table>

</tal:block>

